# 臨床欄位擴充說明

## 📋 概述

已為藥物資料庫新增 10 個臨床資訊欄位,讓管理系統能夠完整記錄藥物的詳細資訊。

## ✅ 新增欄位列表

### 1. 適應症 (indications)
- **類型**: TEXT
- **說明**: 記錄藥物可治療的疾病或症狀
- **範例**: "用於緩解輕至中度疼痛、發熱、關節炎、風濕病等症狀"
- **顯示位置**: 臨床資訊頁籤

### 2. 用法用量 (dosage)
- **類型**: TEXT
- **說明**: 記錄藥物的服用方法和劑量
- **範例**: "成人口服,一次1-2錠,每4-6小時一次,每日最多不超過12錠"
- **顯示位置**: 臨床資訊頁籤

### 3. 副作用 (side_effects)
- **類型**: TEXT
- **說明**: 記錄藥物可能引起的不良反應
- **範例**: "可能引起胃腸不適、消化道出血等。長期大量使用可能影響肝功能"
- **顯示位置**: 臨床資訊頁籤

### 4. 禁忌症 (contraindications)
- **類型**: TEXT
- **說明**: 記錄哪些情況下不能使用此藥物
- **範例**: "對水楊酸類藥物過敏者禁用,消化性潰瘍活動期、出血傾向患者慎用"
- **顯示位置**: 臨床資訊頁籤

### 5. 注意事項 (precautions)
- **類型**: TEXT
- **說明**: 記錄使用藥物時需要注意的事項
- **範例**: "服藥期間避免飲酒,兒童感冒發熱慎用。有高血壓、心臟病等基礎疾病患者使用前應諮詢醫師"
- **顯示位置**: 臨床資訊頁籤

### 6. 主要成分 (ingredient)
- **類型**: TEXT
- **說明**: 記錄藥物的主要有效成分
- **範例**: "乙醯水楊酸"
- **顯示位置**: 其他資訊頁籤

### 7. 藥品分類 (category)
- **類型**: TEXT
- **說明**: 記錄藥物的分類類別
- **範例**: "消炎止痛藥"、"抗生素"、"降血壓藥"
- **顯示位置**: 其他資訊頁籤

### 8. 製造商 (manufacturer)
- **類型**: TEXT
- **說明**: 記錄製造此藥物的廠商名稱
- **範例**: "拜耳藥廠"、"台灣諾華"
- **顯示位置**: 其他資訊頁籤

### 9. 儲存條件 (storage_conditions)
- **類型**: TEXT
- **說明**: 記錄藥物的保存方式和條件
- **範例**: "室溫保存,避免高溫潮濕,開封後請於一個月內使用完畢"
- **顯示位置**: 其他資訊頁籤

### 10. 有效期限 (expiry_info)
- **類型**: TEXT
- **說明**: 記錄藥物的有效期限資訊
- **範例**: "三年"、"請參閱包裝上標示"
- **顯示位置**: 其他資訊頁籤

## 🔧 資料庫遷移

已執行資料庫遷移腳本,新增欄位詳情:

```bash
# 執行遷移腳本
cd d:\大學\專題\MUS_Project\scripts
python add_clinical_fields.py
```

**遷移結果**:
- ✅ 成功新增 10 個欄位
- ✅ 所有欄位預設為 NULL (選填)
- ✅ 不影響現有資料

## 🎨 UI 更新

管理系統使用 **TabControl** 分頁設計,將欄位分為三個頁籤:

### 📁 基本資訊 (tabBasic)
- 許可證字號 (必填)
- 中文品名 (必填)
- 英文品名
- 形狀、特殊劑型
- 顏色、特殊氣味
- 刻痕
- 外觀尺寸
- 標註一、標註二

### 💊 臨床資訊 (tabClinical)
- 適應症 (多行文字框)
- 用法用量 (多行文字框)
- 副作用 (多行文字框)
- 禁忌症 (多行文字框)
- 注意事項 (多行文字框)

### 📦 其他資訊 (tabOther)
- 主要成分
- 藥品分類
- 製造商
- 儲存條件 (多行文字框)
- 有效期限

## 💾 CRUD 操作

### 新增藥物
1. 點選「新增」按鈕
2. 在「基本資訊」頁籤填寫必填欄位
3. 切換到「臨床資訊」頁籤填寫臨床資料 (選填)
4. 切換到「其他資訊」頁籤填寫額外資訊 (選填)
5. 點選「儲存」

### 編輯藥物
1. 選擇藥物資料列
2. 點選「編輯」按鈕
3. 在各頁籤修改欄位內容
4. 點選「儲存」

### 查看藥物
- 在 DataGridView 中可看到所有欄位 (包含新增的 10 個欄位)
- 使用搜尋功能可搜尋所有欄位內容

## 🔍 搜尋功能

目前搜尋功能支援:
- 許可證字號
- 中文品名
- 英文品名

如需擴充搜尋範圍到臨床欄位,可修改 `DrugDatabase.cs` 中的 `SearchDrugs` 方法:

```csharp
if (!string.IsNullOrWhiteSpace(keyword))
{
    conditions.Add(@"(license_number LIKE @keyword 
                    OR chinese_name LIKE @keyword 
                    OR english_name LIKE @keyword
                    OR indications LIKE @keyword
                    OR ingredient LIKE @keyword)");
    parameters.Add(new SQLiteParameter("@keyword", $"%{keyword}%"));
}
```

## 📊 DataGridView 顯示

MainForm 的 DataGridView 已自動更新,會顯示所有 21 個欄位:

**基本資訊** (11 欄):
- 許可證字號、中文品名、英文品名、形狀、特殊劑型、顏色、特殊氣味、刻痕、外觀尺寸、標註一、標註二

**臨床資訊** (5 欄):
- 適應症、用法用量、副作用、禁忌症、注意事項

**其他資訊** (5 欄):
- 主要成分、藥品分類、製造商、儲存條件、有效期限

## 🚀 啟動管理系統

```powershell
cd "d:\大學\專題\MUS_Project\admin_tool"
.\start_admin.ps1
```

或直接執行:
```powershell
dotnet run
```

## 📝 資料輸入建議

### 適應症
建議使用完整句子描述,例如:
- "用於治療高血壓、心絞痛"
- "緩解感冒引起的發燒、頭痛、肌肉酸痛"

### 用法用量
建議包含以下資訊:
- 服用途徑 (口服、外用、注射等)
- 單次劑量
- 服用頻率
- 注意事項

### 副作用
建議按嚴重程度分類:
- 常見副作用
- 少見但嚴重的副作用

### 禁忌症
建議明確列出:
- 過敏史
- 特定疾病患者
- 孕婦、哺乳婦、兒童等特殊族群

## 🔄 未來擴充建議

1. **下拉選單**: 為「藥品分類」增加預定義選項
2. **日期選擇器**: 為「有效期限」增加日期選擇功能
3. **富文本編輯**: 為多行文字框增加格式化功能
4. **資料驗證**: 增加欄位格式驗證 (如劑量格式)
5. **歷史記錄**: 記錄欄位修改歷史

## ⚠️ 注意事項

1. 所有新增欄位皆為**選填**,不影響現有資料的完整性
2. 在編輯模式下,未填寫的欄位會顯示為空白
3. 資料庫中的 NULL 值會在 UI 顯示為空字串
4. 建議定期備份資料庫以防資料遺失

## 🐛 疑難排解

### 欄位沒有顯示
1. 確認資料庫遷移已執行成功
2. 重新編譯管理系統: `dotnet build`
3. 清除快取: `dotnet clean`

### 儲存失敗
1. 檢查必填欄位是否已填寫
2. 確認資料庫連線正常
3. 查看錯誤訊息以了解具體問題

### DataGridView 顯示不完整
1. 視窗太小無法顯示所有欄位
2. 使用水平捲軸查看更多欄位
3. 可調整欄位寬度或隱藏不常用欄位

## 📞 技術支援

如有問題請參考:
- README.md - 系統安裝與使用說明
- QUICKSTART.md - 快速開始指南
- 本文件 - 臨床欄位擴充說明
